<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
    <head>
        <meta name="generator" content=
        "HTML Tidy for HTML5 for Linux version 5.6.0" />
        <meta http-equiv="Content-Type" content=
        "text/html; charset=utf-8" />
        <link rel="stylesheet" href=
        "../jacoco-resources/report.css" type="text/css" />
        <link rel="shortcut icon" href=
        "../jacoco-resources/report.gif" type="image/gif" />
        <title>
            ButlerUtils.java
        </title>
        <link rel="stylesheet" href=
        "../jacoco-resources/prettify.css" type="text/css" />
        <script type="text/javascript" src=
        "../jacoco-resources/prettify.js"></script>
    </head>
    <body onload="window['PR_TAB_WIDTH']=4;prettyPrint()">
        <div class="breadcrumb" id="breadcrumb">
            <span class="info"><a href="../jacoco-sessions.html"
            class="el_session">Sessions</a></span><a href=
            "../index.html" class="el_report">MyDiscordButler</a>
            &gt; <a href="index.source.html" class=
            "el_package">com.niklasarndt.discordbutler.util</a>
            &gt; <span class="el_source">ButlerUtils.java</span>
        </div>
        <h1>
            ButlerUtils.java
        </h1>
        <pre class="source lang-java linenums">
        package com.niklasarndt.discordbutler.util;

import com.niklasarndt.discordbutler.modules.ButlerCommandInformation;
import net.dv8tion.jda.api.entities.MessageEmbed;
import net.dv8tion.jda.internal.utils.tuple.Pair;

/**
 * Created by Niklas on 2020/07/25.
 */
public class ButlerUtils {

    private ButlerUtils() {
    }

    public static String prettyPrintTime(long ms) {
<span class="fc" id=
"L16">        return prettyPrintTime(ms, false);</span>
    }

    public static String prettyPrintTime(long ms, boolean includeMs) {
<span class="fc bfc" id="L20" title=
"All 2 branches covered.">        if (ms &lt;= 0) {</span>
<span class="fc" id=
"L21">            throw new IllegalArgumentException(</span>
<span class="fc" id=
"L22">                    String.format("The provided long must be larger than zero! (set: %d)", ms));</span>
        }
<span class="fc bfc" id="L24" title=
"All 4 branches covered.">        if (!includeMs &amp;&amp; ms &lt; 1000) ms = 1000;</span>
<span class="fc" id=
"L25">        StringBuilder builder = new StringBuilder();</span>

<span class="fc" id=
"L27">        int days = (int) (ms / 86400000); //1.000 * 60 * 60 * 24</span>
<span class="fc" id=
"L28">        appendTime(builder, days, "day");</span>

<span class="fc" id=
"L30">        int hours = (int) (ms / 3600000) % 24; //1.000 * 60 * 60</span>
<span class="fc" id=
"L31">        appendTime(builder, hours, "hour");</span>

<span class="fc" id=
"L33">        int minutes = (int) (ms / 60000) % 60; //1.000 * 60;</span>
<span class="fc" id=
"L34">        appendTime(builder, minutes, "minute");</span>

<span class="fc" id=
"L36">        int seconds = (int) (ms / 1000) % 60; //1.000 * 60;</span>
<span class="fc" id=
"L37">        appendTime(builder, seconds, "second");</span>

<span class="fc bfc" id="L39" title=
"All 2 branches covered.">        if (includeMs) {</span>
<span class="fc" id=
"L40">            int milliseconds = (int) (ms % 1000);</span>
<span class="fc" id=
"L41">            appendTime(builder, milliseconds, "millisecond");</span>
        }

<span class="fc" id=
"L44">        return builder.substring(0, builder.length() - 2);</span>
    }

    private static void appendTime(StringBuilder builder, int num, String singular) {
<span class="fc bfc" id="L48" title=
"All 2 branches covered.">        if (num &gt; 0) builder.append(timeDisplay(num, singular));</span>
<span class="fc" id="L49">    }</span>

    private static String timeDisplay(int num, String singular) {
<span class="fc bfc" id="L52" title=
"All 2 branches covered.">        return String.format("%02d %s, ", num, num == 1 ? singular : singular + "s");</span>
    }

    public static long parseTimeString(String input) {
<span class="fc" id=
"L56">        String[] keys = {"d", "h", "m", "s"};</span>
<span class="fc" id=
"L57">        int[] values = new int[keys.length]; //Days, Hours, Minutes, Seconds</span>


<span class="fc bfc" id="L60" title=
"All 2 branches covered.">        for (int i = 0; i &lt; keys.length; i++) {</span>
<span class="fc" id=
"L61">            Pair&lt;String, Integer&gt; out = parseAndEdit(input, keys[i]);</span>
<span class="fc" id="L62">            input = out.getLeft();</span>
<span class="fc" id=
"L63">            values[i] = out.getRight();</span>
        }

<span class="fc" id=
"L66">        return ((((values[0] * 24) + values[1]) * 60 + values[2]) * 60 + values[3]) * 1000;</span>
    }

    private static Pair&lt;String, Integer&gt; parseAndEdit(String input, String letter) {
<span class="fc bfc" id="L70" title=
"All 2 branches covered.">        if (input.contains(letter)) {</span>
<span class="fc" id=
"L71">            String num = input.substring(0, input.indexOf(letter));</span>
<span class="fc" id=
"L72">            input = input.substring(input.indexOf(letter) + letter.length());</span>
<span class="fc" id=
"L73">            return generatePair(input, parseInt(num, 0));</span>
        }
<span class="fc" id=
"L75">        return generatePair(input, 0);</span>
    }

    private static Pair&lt;String, Integer&gt; generatePair(String left, Integer right) {
<span class="fc" id=
"L79">        return new Pair&lt;&gt;() {</span>
            @Override
            public String getLeft() {
<span class="fc" id="L82">                return left;</span>
            }

            @Override
            public Integer getRight() {
<span class="fc" id="L87">                return right;</span>
            }
        };
    }

    public static String buildShortCommandInfo(ButlerCommandInformation info, int maxCommandLength,
                                               int maxDescLength) {
<span class="fc" id=
"L94">        String desc = trimString(info.getDescription(), maxDescLength);</span>

<span class="fc" id=
"L96">        return String.format(String.format("`%%-%ds`: `%%-%ds`", maxCommandLength, maxDescLength),</span>
<span class="fc" id="L97">                info.getName(),</span>
                desc);
    }

    public static String buildShortCommandInfo(ButlerCommandInformation info) {
<span class="nc" id=
"L102">        return buildShortCommandInfo(info, 16, 50);</span>
    }

    public static String trimString(String input, int maxLength) {
<span class="pc bpc" id="L106" title=
"1 of 2 branches missed.">        if (maxLength &lt; 1) throw new IllegalArgumentException(</span>
                "The maximum string length must be larger than zero.");

<span class="fc bfc" id="L109" title=
"All 2 branches covered.">        if (maxLength &lt; 4) {</span>
<span class="fc" id=
"L110">            return ".".repeat(maxLength);</span>
        }

<span class="fc bfc" id="L113" title=
"All 2 branches covered.">        return input.length() &gt; maxLength ?</span>
<span class="fc" id=
"L114">                input.substring(0, maxLength - 3) + "..." :</span>
<span class="fc" id="L115">                input;</span>
    }

    public static MessageEmbed.Field buildEmbedCommandInfo(
            ButlerCommandInformation info, int maxDescLength, boolean inline) {
<span class="nc" id=
"L120">        return new MessageEmbed.Field(info.getName(),</span>
<span class="nc" id=
"L121">                trimString(info.getDescription(), maxDescLength), inline);</span>
    }

    public static MessageEmbed.Field buildEmbedCommandInfo(ButlerCommandInformation info) {
<span class="nc" id=
"L125">        return buildEmbedCommandInfo(info, 50, true);</span>
    }

    public static int parseInt(String input, int defaultValue) {
        try {
<span class="fc" id=
"L130">            return Integer.parseInt(input);</span>
<span class="fc" id=
"L131">        } catch (NumberFormatException e) {</span>
<span class="fc" id="L132">            return defaultValue;</span>
        }
    }
}
</pre>
        <div class="footer">
            <span class="right">Created with <a href=
            "http://www.jacoco.org/jacoco">JaCoCo</a>
            0.8.5.201910111838</span>
        </div>
    </body>
</html>
